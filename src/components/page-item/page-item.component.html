<div class="bg-slate-800/50 rounded-lg shadow-lg overflow-hidden">
  <div class="p-4 bg-slate-800 border-b border-slate-700 flex justify-between items-center">
    <h3 class="text-lg font-medium text-white">{{ page().name }}</h3>
    <button (click)="onDelete()" class="text-slate-400 hover:text-red-400 transition-colors" title="Delete Page">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
        </svg>
    </button>
  </div>
  <div class="grid grid-cols-1 md:grid-cols-2 gap-px">
    <!-- Left Column: Image and Instructions -->
    <div class="bg-slate-800/25 p-4 space-y-4">
      <div>
        <h4 class="text-sm font-medium text-slate-400 mb-2">Page Thumbnail</h4>
        <div class="relative group">
          <img [ngSrc]="page().imageUrl" alt="Page screenshot" class="rounded-md w-full object-cover aspect-[4/3] bg-slate-700" width="800" height="600">
        </div>
      </div>
      <div>
        <h4 class="text-sm font-medium text-slate-400 mb-2">Instructions</h4>
        <p class="text-slate-300 text-sm bg-slate-700/50 p-3 rounded-md min-h-[60px]">
          {{ page().instructions }}
        </p>
      </div>
    </div>

    <!-- Right Column: Actions and Code Output -->
    <div class="bg-slate-800/25 p-4 flex flex-col">
      <div class="flex-grow flex flex-col">
        @switch (page().status) {
          @case ('idle') {
            <div class="flex-grow flex flex-col items-center justify-center text-center text-slate-400 border-2 border-dashed border-slate-700 rounded-md p-4">
               <svg xmlns="http://www.w3.org/2000/svg" class="mx-auto h-10 w-10 text-slate-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.75 3.104v5.714a2.25 2.25 0 01-.659 1.591L5 14.5M9.75 3.104c.251-.143.52-.254.795-.331a12.136 12.136 0 011.08 0c.275.077.544.188.795.331m-2.67 0a1.06 1.06 0 012.67 0M11.25 6.463v5.714a2.25 2.25 0 00.659 1.591L16 14.5M11.25 6.463c.251-.143.52-.254.795-.331a12.136 12.136 0 001.08 0c.275.077.544.188.795.331m-2.67 0a1.06 1.06 0 002.67 0m-2.67 0C9.6 6.178 8.75 6.5 8.75 7.125v5.714a2.25 2.25 0 00.659 1.591L14.25 18l.85-3.398" />
              </svg>
              <h4 class="mt-2 font-medium text-slate-300">Ready to Generate</h4>
              <p class="mt-1 text-sm">Click "Generate Test" to create the Robot code for this page.</p>
            </div>
          }
          @case ('loading') {
            <div class="flex-grow flex flex-col items-center justify-center space-y-4">
              <svg class="animate-spin h-10 w-10 text-indigo-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
              <p class="text-slate-300 text-sm animate-pulse">AI is generating test...</p>
            </div>
          }
          @case ('generated') {
            <div class="flex-grow flex flex-col min-h-[250px] border border-slate-700 rounded-md">
              <app-code-editor [initialCode]="page().robotCode!" [readonly]="true"></app-code-editor>
            </div>
          }
          @case ('error') {
             <div class="flex-grow flex flex-col items-center justify-center text-center text-red-400 bg-red-900/50 p-4 rounded-lg">
              <h4 class="font-bold">Generation Failed</h4>
              <p class="text-sm mt-2">{{ page().errorMessage }}</p>
            </div>
          }
        }
      </div>
      <div class="mt-4 pt-4 border-t border-slate-700 flex items-center justify-between">
        @if (page().status === 'generated') {
          <span class="text-sm text-green-400 flex items-center">
             <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
            </svg>
            Code Generated
          </span>
          <button (click)="downloadFile()" class="ml-3 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-slate-600 hover:bg-slate-700" title="Download .robot file">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
            </svg>
            Download
          </button>
        } @else {
           <div class="w-full"></div>
        }
      </div>
    </div>
  </div>
</div>